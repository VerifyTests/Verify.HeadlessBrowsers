<!--
GENERATED FILE - DO NOT EDIT
This file was generated by [MarkdownSnippets](https://github.com/SimonCropp/MarkdownSnippets).
Source File: /readme.source.md
To change this file edit the source file and then run MarkdownSnippets.
-->

# <img src="/src/icon.png" height="30px"> Verify.Uno

[![Build status](https://ci.appveyor.com/api/projects/status/rbkfpdk6o1cc3ih9?svg=true)](https://ci.appveyor.com/project/SimonCropp/verify-uno)
[![NuGet Status](https://img.shields.io/nuget/v/Verify.Uno.svg)](https://www.nuget.org/packages/Verify.Uno/)

Extends [Verify](https://github.com/VerifyTests/Verify) to allow verification of [Uno UIs](https://platform.uno/).

Leverages the [Uno.UITest](https://github.com/unoplatform/Uno.UITest).

Support is available via a [Tidelift Subscription](https://tidelift.com/subscription/pkg/nuget-verify.uno?utm_source=nuget-verify.uno&utm_medium=referral&utm_campaign=enterprise).

**Currently only supported for Uno Wasm projects**

<!-- toc -->
## Contents

  * [Usage](#usage)
    * [Target page](#target-page)
    * [Testing](#testing)
  * [OS specific rendering](#os-specific-rendering)
  * [Security contact information](#security-contact-information)<!-- endtoc -->


## NuGet package

https://nuget.org/packages/Verify.Uno/


## Usage


### Target page

Given the following page

<!-- snippet: MainPage.xaml -->
<a id='snippet-MainPage.xaml'/></a>
```xaml
<Page
    x:Class="SampleApp.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
        <StackPanel>
            <TextBlock x:Uid="first" Text="The first element" Margin="20" FontSize="30" />
            <TextBlock x:Uid="second" Text="The second element" Margin="20" FontSize="30" />
        </StackPanel>
    </Grid>
</Page>
```
<sup><a href='/src/SampleApp.Wasm/MainPage.xaml#L1-L11' title='File snippet `MainPage.xaml` was extracted from'>snippet source</a> | <a href='#snippet-MainPage.xaml' title='Navigate to start of snippet `MainPage.xaml`'>anchor</a></sup>
<!-- endsnippet -->


### Testing

Enable VerifyUno once at assembly load time:


#### Setup

<!-- snippet: Enable -->
<a id='snippet-enable'/></a>
```cs
VerifyUno.Enable();
```
<sup><a href='/src/Tests/TheTests.cs#L46-L48' title='File snippet `enable` was extracted from'>snippet source</a> | <a href='#snippet-enable' title='Navigate to start of snippet `enable`'>anchor</a></sup>
<!-- endsnippet -->

Setup the Uno app

<!-- snippet: UnoAppSetup -->
<a id='snippet-unoappsetup'/></a>
```cs
var environment = AppInitializer.TestEnvironment;
environment.WebAssemblyDefaultUri = "http://localhost:57416";
environment.CurrentPlatform = Platform.Browser;

app = AppInitializer.AttachToApp();
```
<sup><a href='/src/Tests/TheTests.cs#L35-L41' title='File snippet `unoappsetup` was extracted from'>snippet source</a> | <a href='#snippet-unoappsetup' title='Navigate to start of snippet `unoappsetup`'>anchor</a></sup>
<!-- endsnippet -->

For information on scoping and re-use of the App and Uno.UITest helpers see https://github.com/unoplatform/Uno.UITest


#### App test

The current app state can then be verified as follows:

<!-- snippet: AppUsage -->
<a id='snippet-appusage'/></a>
```cs
[Test]
public async Task AppUsage()
{
    await Verifier.Verify(app);
}
```
<sup><a href='/src/Tests/TheTests.cs#L16-L22' title='File snippet `appusage` was extracted from'>snippet source</a> | <a href='#snippet-appusage' title='Navigate to start of snippet `appusage`'>anchor</a></sup>
<!-- endsnippet -->

With the state of the element being rendered as a verified files:

<!-- snippet: TheTests.AppUsage.Net.00.verified.html -->
<a id='snippet-TheTests.AppUsage.Net.00.verified.html'/></a>
```html
<html>
  <body>
    <div xaml="MainPage"  tabindex="0" style="width: 1024px; height: 768px">
      <div xaml="Grid"  style="width: 1024px; height: 768px">
        <div xaml="StackPanel"  style="width: 1024px; height: 768px">
          <p xaml="TextBlock"  id="first" wrap="off" style="font-size: 30px; top: 20px; left: 20px; width: 984px; height: 40px">The first element</p>
          <p xaml="TextBlock"  id="second" wrap="off" style="font-size: 30px; top: 100px; left: 20px; width: 984px; height: 40px">The second element</p>
        </div>
      </div>
    </div>
  </body>
</html>
```
<sup><a href='/src/Tests/TheTests.AppUsage.Net.00.verified.html#L1-L12' title='File snippet `TheTests.AppUsage.Net.00.verified.html` was extracted from'>snippet source</a> | <a href='#snippet-TheTests.AppUsage.Net.00.verified.html' title='Navigate to start of snippet `TheTests.AppUsage.Net.00.verified.html`'>anchor</a></sup>
<!-- endsnippet -->

[TheTests.AppUsage.Net.01.verified.png](/src/Tests/TheTests.AppUsage.Net.01.verified.png):

<img src="/src/Tests/TheTests.AppUsage.Net.01.verified.png" width="400px">


#### Element test

An element can be verified as follows:

<!-- snippet: ElementUsage -->
<a id='snippet-elementusage'/></a>
```cs
[Test]
public async Task ElementUsage()
{
    var element = app.WaitForElement(query => query.Marked("second"))!;
    await Verifier.Verify(element.Single());
}
```
<sup><a href='/src/Tests/TheTests.cs#L24-L31' title='File snippet `elementusage` was extracted from'>snippet source</a> | <a href='#snippet-elementusage' title='Navigate to start of snippet `elementusage`'>anchor</a></sup>
<!-- endsnippet -->

With the state of the element being rendered as a verified files:

<!-- snippet: TheTests.ElementUsage.Net.00.verified.html -->
<a id='snippet-TheTests.ElementUsage.Net.00.verified.html'/></a>
```html
<html>
  <body>
    <p xaml="TextBlock"  id="second" wrap="off" style="font-size: 30px; top: 100px; left: 20px; width: 984px; height: 40px">The second element</p>
  </body>
</html>
```
<sup><a href='/src/Tests/TheTests.ElementUsage.Net.00.verified.html#L1-L5' title='File snippet `TheTests.ElementUsage.Net.00.verified.html` was extracted from'>snippet source</a> | <a href='#snippet-TheTests.ElementUsage.Net.00.verified.html' title='Navigate to start of snippet `TheTests.ElementUsage.Net.00.verified.html`'>anchor</a></sup>
<!-- endsnippet -->

[TheTests.ElementUsage.Net.01.verified.png](/src/Tests/TheTests.ElementUsage.Net.01.verified.png):

<img src="/src/Tests/TheTests.ElementUsage.Net.01.verified.png" width="400px">


## OS specific rendering

The rendering of Form elements can very slightly between different OS versions. This can make verification on different machines (eg CI) problematic. There are several approaches to mitigate this:

 * Using a [custom comparer](https://github.com/VerifyTests/Verify/blob/master/docs/comparer.md)


## Security contact information

To report a security vulnerability, use the [Tidelift security contact](https://tidelift.com/security). Tidelift will coordinate the fix and disclosure.


## Icon

[Gem](https://thenounproject.com/term/gem/2247823/) designed by [Adnen Kadri](https://thenounproject.com/adnen.kadri/) from [The Noun Project](https://thenounproject.com/creativepriyanka).
